<div *ngIf="showSignUp" class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90 backdrop-blur-sm">
  <!-- Form Container -->
  <div class="relative w-full max-w-3xl mx-4">
    <!-- Glowing border effect -->
    <div class="absolute -inset-1 rounded-xl bg-gradient-to-r from-yellow-500 to-yellow-600 opacity-20 blur-sm"></div>

    <!-- Main Card -->
    <div class="relative bg-gray-900 rounded-xl shadow-2xl overflow-hidden border border-gray-700/50">
      <!-- Luxury top accent bar -->
      <div class="h-1.5 bg-gradient-to-r from-yellow-400 via-yellow-500 to-yellow-600"></div>

      <!-- Close Button -->
      <button (click)="closeSignup()" class="absolute top-4 right-4 p-1 rounded-full bg-gray-800/80 hover:bg-gray-700/80 transition-all">
        <svg class="w-6 h-6 text-gray-400 hover:text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
        </svg>
      </button>

      <!-- Form Content -->
      <div class="p-8">
        <!-- Logo and Header -->
        <div class="text-center mb-8">
          <img src="../../../../assets/logo2.png" alt="BAG Logo" class="h-10 mx-auto mb-4">
          <h2 class="text-2xl font-bold text-white">Créez votre compte</h2>
          <p class="text-gray-400 mt-2">Rejoignez la famille Bugshan Automotive</p>
        </div>

        <!-- Success Notification -->
        <div *ngIf="userAdded" class="mb-6 bg-gradient-to-r from-green-500 to-green-600 text-white px-6 py-3 rounded-lg flex items-center space-x-3 animate-fade-in">
          <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
          </svg>
          <span class="font-semibold">{{ successMessage }}</span>
        </div>

        <form (submit)="onSignup($event)" #userForm="ngForm" class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Full Name -->
          <div class="relative">
            <input type="text"
                   class="w-full px-4 pt-6 pb-2 bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:ring-1 focus:ring-yellow-500 focus:border-yellow-500 text-white transition-all duration-300 peer"
                   name="fullName"
                   [(ngModel)]="newUser.nomComplet"
                   placeholder=" "
                   required #fullName="ngModel">
            <label class="absolute left-4 top-2 text-gray-400 text-sm peer-focus:text-yellow-400 peer-focus:text-xs peer-focus:top-2 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base transition-all duration-300">
              Nom complet <span class="text-red-500">*</span>
            </label>
            <div *ngIf="fullName.invalid && fullName.touched" class="text-red-400 text-xs mt-1">Le nom est requis.</div>
          </div>

          <!-- Username -->
          <div class="relative">
            <input type="text"
                   class="w-full px-4 pt-6 pb-2 bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:ring-1 focus:ring-yellow-500 focus:border-yellow-500 text-white transition-all duration-300 peer"
                   name="username"
                   [(ngModel)]="newUser.nomUtilisateur"
                   placeholder=" "
                   required #username="ngModel"
                   (ngModelChange)="checkUsername()">
            <label class="absolute left-4 top-2 text-gray-400 text-sm peer-focus:text-yellow-400 peer-focus:text-xs peer-focus:top-2 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base transition-all duration-300">
              Nom d'utilisateur <span class="text-red-500">*</span>
            </label>
            <div *ngIf="username.invalid && username.touched" class="text-red-400 text-xs mt-1">Le nom d'utilisateur est requis.</div>
            <div *ngIf="usernameTaken" class="text-red-400 text-xs mt-1">{{errorMessage}}</div>
          </div>

          <!-- Gender -->
          <div class="relative">
            <select class="w-full px-4 pt-6 pb-2 bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:ring-1 focus:ring-yellow-500 focus:border-yellow-500 text-white appearance-none peer"
                    name="gender"
                    [(ngModel)]="newUser.sexe"
                    required #gender="ngModel">
              <option value="" disabled selected></option>
              <option value="HOMME">Homme</option>
              <option value="FEMME">Femme</option>
            </select>
            <label class="absolute left-4 top-2 text-gray-400 text-sm peer-focus:text-yellow-400 peer-focus:text-xs peer-focus:top-2 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base transition-all duration-300">
              Genre <span class="text-red-500">*</span>
            </label>
            <div class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </div>
            <div *ngIf="gender.invalid && gender.touched" class="text-red-400 text-xs mt-1">Le genre est requis.</div>
          </div>

          <!-- Email -->
          <div class="relative">
            <input type="email"
                   class="w-full px-4 pt-6 pb-2 bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:ring-1 focus:ring-yellow-500 focus:border-yellow-500 text-white transition-all duration-300 peer"
                   name="email"
                   [(ngModel)]="newUser.email"
                   placeholder=" "
                   required #email="ngModel"
                   (ngModelChange)="validateEmail(newUser.email)">
            <label class="absolute left-4 top-2 text-gray-400 text-sm peer-focus:text-yellow-400 peer-focus:text-xs peer-focus:top-2 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base transition-all duration-300">
              Adresse e-mail <span class="text-red-500">*</span>
            </label>
            <div *ngIf="email.invalid && email.touched" class="text-red-400 text-xs mt-1">Un email valide est requis.</div>
            <div *ngIf="emailInvalid || emailTakenError" class="text-red-400 text-xs mt-1">{{errorMessage}}</div>
          </div>

          <!-- Phone Number -->
          <div class="relative">
            <input type="tel"
                   class="w-full px-4 pt-6 pb-2 bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:ring-1 focus:ring-yellow-500 focus:border-yellow-500 text-white transition-all duration-300 peer"
                   name="phoneNumber"
                   [(ngModel)]="newUser.numeroTelephone"
                   placeholder=" "
                   required #phoneNumber="ngModel"
                   (ngModelChange)="validateGSM(newUser.numeroTelephone)">
            <label class="absolute left-4 top-2 text-gray-400 text-sm peer-focus:text-yellow-400 peer-focus:text-xs peer-focus:top-2 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base transition-all duration-300">
              Numéro de téléphone <span class="text-red-500">*</span>
            </label>
            <div *ngIf="phoneNumber.invalid && phoneNumber.touched" class="text-red-400 text-xs mt-1">Le numéro de téléphone est requis.</div>
            <div *ngIf="gsmInvalid || gsmTakenError" class="text-red-400 text-xs mt-1">{{errorMessage}}</div>
          </div>

          <!-- Password -->
          <div class="relative">
            <input [type]="showPassword ? 'text' : 'password'"
                   class="w-full px-4 pt-6 pb-2 bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:ring-1 focus:ring-yellow-500 focus:border-yellow-500 text-white transition-all duration-300 peer"
                   name="password"
                   [(ngModel)]="newUser.motDePasse"
                   placeholder=" "
                   required #password="ngModel"
                   (ngModelChange)="validatePassword(newUser.motDePasse)">
            <label class="absolute left-4 top-2 text-gray-400 text-sm peer-focus:text-yellow-400 peer-focus:text-xs peer-focus:top-2 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base transition-all duration-300">
              Mot de passe <span class="text-red-500">*</span>
            </label>
            <button type="button" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-yellow-400" (click)="togglePasswordVisibility()">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
              </svg>
            </button>
            <div *ngIf="password.invalid && password.touched" class="text-red-400 text-xs mt-1">Le mot de passe est requis.</div>
            <div *ngIf="passwordInvalid" class="text-red-400 text-xs mt-1">{{errorMessage}}</div>
          </div>

          <!-- City -->
          <div class="relative">
            <select class="w-full px-4 pt-6 pb-2 bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:ring-1 focus:ring-yellow-500 focus:border-yellow-500 text-white appearance-none peer"
                    name="city"
                    [(ngModel)]="newUser.ville"
                    required #city="ngModel">
              <option value="" disabled selected></option>
              <option *ngFor="let city of cities" [value]="city">{{ city | titlecase }}</option>
            </select>
            <label class="absolute left-4 top-2 text-gray-400 text-sm peer-focus:text-yellow-400 peer-focus:text-xs peer-focus:top-2 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base transition-all duration-300">
              Ville <span class="text-red-500">*</span>
            </label>
            <div class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </div>
            <div *ngIf="city.invalid && city.touched" class="text-red-400 text-xs mt-1">La ville est requise.</div>
          </div>

          <!-- Address -->
          <div class="relative col-span-1 md:col-span-2">
            <textarea class="w-full px-4 pt-6 pb-2 bg-gray-800 border border-gray-700 rounded-lg focus:outline-none focus:ring-1 focus:ring-yellow-500 focus:border-yellow-500 text-white transition-all duration-300 peer min-h-[100px]"
                      id="address"
                      [(ngModel)]="newUser.adresse"
                      name="address"
                      required
                      #address="ngModel"
                      placeholder=" "></textarea>
            <label class="absolute left-4 top-2 text-gray-400 text-sm peer-focus:text-yellow-400 peer-focus:text-xs peer-focus:top-2 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base transition-all duration-300">
              Adresse <span class="text-red-500">*</span>
            </label>
            <div *ngIf="address.invalid && address.touched" class="text-red-400 text-xs mt-1">
              L'adresse est requise.
            </div>
          </div>

          <!-- Profile Picture -->
          <div class="col-span-1 md:col-span-2">
            <label class="block text-gray-400 text-sm mb-2">Photo de profil <span class="text-gray-500">(Optionnel)</span></label>
            <div class="flex items-center space-x-4">
              <label for="photo" class="cursor-pointer bg-gray-800 border border-gray-700 hover:border-yellow-500 text-white py-2 px-4 rounded-lg shadow-md hover:bg-gray-700 transition-all duration-300 flex items-center">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                </svg>
                Choisir un fichier
              </label>
              <input type="file" id="photo" class="hidden" (change)="onFileChange($event)" accept="image/*">
              <div *ngIf="newUser.urlImage" class="relative">
                <img [src]="newUser.urlImage" alt="Aperçu de la photo" class="w-16 h-16 object-cover rounded-lg border border-gray-700">
                <button type="button" (click)="removeImage()" class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center">
                  <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                  </svg>
                </button>
              </div>
            </div>
            <div *ngIf="imageError" class="text-red-400 text-xs mt-1">
              {{ imageError }}
            </div>
          </div>

          <!-- Submit Button -->
          <div class="col-span-1 md:col-span-2 mt-2">
            <button type="submit"
                    [disabled]="loading"
                    class="w-full bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-white font-medium py-3 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center">
              <span *ngIf="loading" class="animate-spin border-4 border-white border-t-transparent rounded-full w-5 h-5 mr-2"></span>
              Créer un compte
            </button>
          </div>
        </form>

        <!-- Login Link -->
        <div class="mt-6 text-center text-sm text-gray-400">
          Déjà membre?
          <button (click)="closeSignup()" class="text-yellow-500 hover:text-yellow-400 hover:underline font-medium transition-colors">Connectez-vous</button>
        </div>
      </div>
    </div>
  </div>
</div>
